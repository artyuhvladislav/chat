(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a.n(s),n=a(47),r=a.n(n),o=(a(22),a(3)),u=a(9),j=a(17),i=a.n(j),l=a(48),d=a.n(l)()(),O=a(0),b=function(e){var t=e.onLogin,a=c.a.useState(""),s=Object(u.a)(a,2),n=s[0],r=s[1],o=c.a.useState(""),j=Object(u.a)(o,2),l=j[0],d=j[1],b=c.a.useState(!1),m=Object(u.a)(b,2),h=m[0],p=m[1];return Object(O.jsxs)("div",{className:"join-block",children:[Object(O.jsx)("input",{type:"text",placeholder:"roomID",value:n,onChange:function(e){return r(e.target.value)}}),Object(O.jsx)("input",{type:"text",placeholder:"userName",value:l,onChange:function(e){return d(e.target.value)}}),Object(O.jsx)("button",{disabled:h,className:"btn btn-success",onClick:function(){if(!n||!l)return alert("data is not correct");var e={roomID:n,userName:l};p(!0),i.a.post("/rooms",{userName:l,roomID:n}).then((function(){t(e)}))},children:h?"CONNECTION...":"CONNECT"})]})},m=a(49),h=function(e,t){switch(t.type){case"JOINED":return Object(o.a)(Object(o.a)({},e),{},{joined:!0,userName:t.payload.userName,roomID:t.payload.roomID});case"SET_USERS":return Object(o.a)(Object(o.a)({},e),{},{users:t.payload});case"NEW_MESSAGES":return Object(o.a)(Object(o.a)({},e),{},{messages:[].concat(Object(m.a)(e.messages),[t.payload])});case"SET_DATA":return Object(o.a)(Object(o.a)({},e),{},{users:t.payload.users,messages:t.payload.messages});default:return e}};var p=function(e){var t=e.users,a=e.messages,s=e.roomID,n=e.userName,r=e.onAddMessage,o=c.a.useState(""),j=Object(u.a)(o,2),i=j[0],l=j[1],b=c.a.useRef(null);return c.a.useEffect((function(){b.current.scrollTo(0,9999)}),[a]),Object(O.jsxs)("div",{className:"chat",children:[Object(O.jsxs)("div",{className:"chat-users",children:["\u041a\u043e\u043c\u043d\u0430\u0442\u0430: ",Object(O.jsx)("b",{children:s}),Object(O.jsx)("hr",{}),Object(O.jsxs)("b",{children:["\u041e\u043d\u043b\u0430\u0439\u043d (",t.length,"):"]}),Object(O.jsx)("ul",{children:t.map((function(e,t){return Object(O.jsx)("li",{children:e},e+t)}))})]}),Object(O.jsxs)("div",{className:"chat-messages",children:[Object(O.jsx)("div",{ref:b,className:"messages",children:a.map((function(e){return Object(O.jsxs)("div",{className:n===e.userName?"usersMessage message":"message",children:[Object(O.jsx)("p",{children:e.text}),Object(O.jsx)("div",{children:Object(O.jsx)("span",{children:e.userName})})]})}))}),Object(O.jsxs)("form",{children:[Object(O.jsx)("textarea",{value:i,onChange:function(e){return l(e.target.value)},className:"form-control",rows:"3"}),Object(O.jsx)("button",{onClick:function(){d.emit("ROOM:NEW_MESSAGES",{userName:n,roomID:s,text:i}),r({userName:n,text:i}),l("")},type:"button",className:"btn btn-primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})]})},N=function(){var e=c.a.useReducer(h,{joined:!1,roomID:null,userName:null,users:[],messages:[]}),t=Object(u.a)(e,2),a=t[0],s=t[1],n=function(e){s({type:"SET_USERS",payload:e})},r=function(e){s({type:"NEW_MESSAGES",payload:e})};return c.a.useEffect((function(){d.on("ROOM:NEW_MESSAGES",r),d.on("ROOM:SET_USERS",n)}),[]),Object(O.jsx)("div",{className:"wrapper",children:a.joined?Object(O.jsx)(p,Object(o.a)(Object(o.a)({},a),{},{onAddMessage:r})):Object(O.jsx)(b,{onLogin:function(e){s({type:"JOINED",payload:e}),d.emit("ROOM:JOIN",e),i.a.get("rooms/".concat(e.roomID)).then((function(e){var t=e.data;s({type:"SET_DATA",payload:t})}))}})})};r.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(N,{})}),document.getElementById("root"))},22:function(e,t,a){}},[[102,1,2]]]);
//# sourceMappingURL=main.f0b4688d.chunk.js.map